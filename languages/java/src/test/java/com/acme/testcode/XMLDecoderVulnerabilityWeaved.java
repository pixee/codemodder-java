package com.acme.testcode;

import io.openpixee.security.XMLDecoderSecurity;

import java.beans.XMLDecoder;
import java.io.InputStream;

import org.xml.sax.InputSource;

final class XMLDecoderVulnerabilityWeaved {

  private static Object stewie2k(InputStream is) {
    XMLDecoder decoder = new XMLDecoder(XMLDecoderSecurity.hardenStream(is));
    return decoder.readObject();
  }

  private static Object skadoodle(InputStream is) {
    XMLDecoder decoder = new XMLDecoder(XMLDecoderSecurity.hardenStream(is), null, null);
    Object object = decoder.readObject();
    return object;
  }

  private static Object shroud(InputSource is) {
    return new XMLDecoder(is).readObject();
  }
}

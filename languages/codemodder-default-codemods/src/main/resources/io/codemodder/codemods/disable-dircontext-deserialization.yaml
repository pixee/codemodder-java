rules:
  - id: disable-dircontext-deserialization
    mode: taint
    pattern-sources:
      - pattern: new SearchControls(...,...,...,...,true,...)
    pattern-sinks:
      - pattern: (DirContext $DC).search(...)
      - pattern: (new InitialDirContext(...)).search(...)
      - pattern: (new InitialLdapContext(...)).search(...)
    message: Semgrep found a match.
    languages: [java]
    severity: WARNING

package com.acme.testcode;

import com.thoughtworks.xstream.XStream;
import com.thoughtworks.xstream.converters.Converter;
import com.thoughtworks.xstream.converters.MarshallingContext;
import com.thoughtworks.xstream.converters.UnmarshallingContext;
import com.thoughtworks.xstream.io.HierarchicalStreamReader;
import com.thoughtworks.xstream.io.HierarchicalStreamWriter;

public final class XStreamVulnerability {

  public Converter converter;

  public Object secure(String xml) {
    XStream xstream = new XStream();
    xstream.registerConverter(converter);
    return xstream.fromXML(xml);
  }

  public Object insecure(String xml) {
    XStream xstream = new XStream();
    return xstream.fromXML(xml);
  }

  void unsure(XStream xstream, String xml) {
    xstream.fromXML(xml);
  }
}

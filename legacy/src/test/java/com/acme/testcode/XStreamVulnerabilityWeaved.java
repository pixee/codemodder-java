package com.acme.testcode;

import com.thoughtworks.xstream.XStream;
import com.thoughtworks.xstream.converters.Converter;
import io.github.pixee.security.HardeningConverter;

public final class XStreamVulnerabilityWeaved {

  public Converter converter;

  public Object secure(String xml) {
    XStream xstream = new XStream();
    xstream.registerConverter(converter);
    return xstream.fromXML(xml);
  }

  public Object insecure(String xml) {
    XStream xstream = new XStream();
    xstream.registerConverter(new HardeningConverter());
      return xstream.fromXML(xml);
  }

    void unsure(XStream xstream, String xml) {
        xstream.fromXML(xml);
    }
}

package com.acme.testcode;

import io.github.pixee.security.ZipSecurity;
import java.io.InputStream;
import java.nio.charset.StandardCharsets;
import java.util.zip.ZipInputStream;

public final class ZipSlipVulnerabilityWeaved {

  /** We'll make a {@link ZipInputStream} out of this. */
  private InputStream is;

  public void openZip() {
    System.out.println("before");
    {
      // this is where we do zip stuff
      ZipSecurity.createHardenedInputStream(is);
      var zip = ZipSecurity.createHardenedInputStream(is, StandardCharsets.UTF_8);
    }
    System.out.println("after");
  }
}

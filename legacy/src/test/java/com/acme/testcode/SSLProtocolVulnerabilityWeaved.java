package com.acme.testcode;

import java.security.NoSuchAlgorithmException;
import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLEngine;
import javax.net.ssl.SSLParameters;
import javax.net.ssl.SSLSocket;

final class SSLProtocolVulnerabilityWeaved {

  public void unsafeContext() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance("TLSv1.2");
  }

  public void unsafeContextFromConstant() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance("TLSv1.2");
  }

  public void safeContext() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance("TLSv1.2");
  }

  public void safeContextFromConstant() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance(TLSV12);
  }

  public SSLContext unsafeReturnsContext() throws NoSuchAlgorithmException {
    return javax.net.ssl.SSLContext.getInstance("TLSv1.2");
  }

  public SSLContext safeReturnsContext() throws NoSuchAlgorithmException {
    return javax.net.ssl.SSLContext.getInstance("TLSv1.2");
  }

  public void unsafeSocketSetProtocols(SSLSocket sslSocket) {
    sslSocket.setEnabledProtocols(new String[] { "TLSv1.2" });
  }

  public void safeSocketSetProtocols(SSLSocket sslSocket) {
    sslSocket.setEnabledProtocols(new String[] {"TLSv1.2"});
  }

  public void unsafeParameters(SSLParameters parameters) {
    parameters.setProtocols(new String[] { "TLSv1.2" });
  }

  public void unsafeParametersFromConstant(SSLParameters parameters) {
    parameters.setProtocols(new String[] { "TLSv1.2" });
  }

  public void safeParameters(SSLParameters parameters) {
    parameters.setProtocols(new String[] {"TLSv1.2"});
  }

  public void unsafeSSLEngineSetProtocols(SSLEngine engine) {
    engine.setEnabledProtocols(new String[] { "TLSv1.2" });
  }

  public void safeSSLEngineSetProtocolsFromConstant(SSLEngine engine) {
    engine.setEnabledProtocols(ONLY_TLSV12);
  }

  private static final String TLSV1 = "TLSv1";
  private static final String[] ONLY_TLSV1 = new String[] {"TLSv1"};
  private static final String TLSV12 = "TLSv1.2";
  private static final String[] ONLY_TLSV12 = new String[] {"TLSv1.2"};
}

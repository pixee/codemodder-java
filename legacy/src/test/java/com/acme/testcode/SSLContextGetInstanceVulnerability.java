package com.acme.testcode;

import javax.net.ssl.SSLContext;
import java.security.NoSuchAlgorithmException;

final class SSLContextGetInstanceVulnerability {

  public void unsafeContext() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance("TLSv1");
  }

  public void unsafeContextFromConstant() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance(TLSV1);
  }

  public void safeContext() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance("TLSv1.2");
  }

  public void safeContextFromConstant() throws NoSuchAlgorithmException {
    SSLContext context = SSLContext.getInstance(TLSV12);
  }

  public SSLContext unsafeReturnsContext() throws NoSuchAlgorithmException {
    return SSLContext.getInstance("TLSv1.1");
  }

  public SSLContext safeReturnsContext() throws NoSuchAlgorithmException {
    return SSLContext.getInstance("TLSv1.2");
  }

  private static final String TLSV1 = "TLSv1";
  private static final String TLSV12 = "TLSv1.2";
}

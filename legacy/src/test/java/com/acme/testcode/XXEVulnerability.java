package com.acme.testcode;

import java.io.StringReader;
import javax.xml.stream.XMLEventReader;
import javax.xml.stream.XMLInputFactory;
import javax.xml.stream.XMLStreamException;

final class XXEVulnerability {

  void readXml(String str) throws XMLStreamException {
    XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();
    XMLEventReader xmlEventReader = xmlInputFactory.createXMLEventReader(new StringReader(str));
    xmlEventReader.nextEvent();
  }

  void readXmlAlreadyProtectedWrapped(String str) throws XMLStreamException {
    XMLInputFactory xmlInputFactory = io.github.pixee.security.XMLInputFactorySecurity.hardenFactory(XMLInputFactory.newFactory());
    XMLEventReader xmlEventReader = xmlInputFactory.createXMLEventReader(new StringReader(str));
    xmlEventReader.nextEvent();
  }

  void readXmlAlreadyProtectedReassigned(String str) throws XMLStreamException {
    XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();
    io.github.pixee.security.XMLInputFactorySecurity.hardenFactory(xmlInputFactory);
    XMLEventReader xmlEventReader = xmlInputFactory.createXMLEventReader(new StringReader(str));
    xmlEventReader.nextEvent();
  }

  void usingNewInstance(String str) throws XMLStreamException {
    XMLInputFactory xmlInputFactory =
        XMLInputFactory.newInstance("", this.getClass().getClassLoader());
    XMLEventReader xmlEventReader = xmlInputFactory.createXMLEventReader(new StringReader(str));
    xmlEventReader.nextEvent();
  }
}
